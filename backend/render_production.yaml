# Render.com Production Configuration
# Para quantpaychain-api2 (Backend Principal)

services:
  - type: web
    name: quantpaychain-api2
    env: python
    region: oregon
    plan: starter  # $7/mes - Sin sleep, mejor performance
    
    # Build
    buildCommand: pip install --extra-index-url https://d33sy5i8bnduwe.cloudfront.net/simple/ -r requirements.txt
    startCommand: uvicorn server:app --host 0.0.0.0 --port $PORT --workers 2 --timeout-keep-alive 65
    
    # Salud y reinicio
    healthCheckPath: /api/assets
    
    # Auto-deploy
    autoDeploy: true
    
    # Variables de entorno
    envVars:
      - key: PYTHON_VERSION
        value: 3.11.0
      
      - key: MONGO_URL
        sync: false  # Configura manualmente
      
      - key: DB_NAME
        value: quantpaychain
      
      - key: SUPABASE_URL
        value: https://ckitbbtlzzxuangsieqo.supabase.co
      
      - key: SUPABASE_KEY
        sync: false
      
      - key: EMERGENT_LLM_KEY
        sync: false
      
      - key: STRIPE_SECRET_KEY
        sync: false
      
      - key: QPC_SERVICE_URL
        value: https://quantpaychain-qpc-service.onrender.com
      
      - key: CORS_ORIGINS
        value: https://www.quantpaychain.com,https://quantpaychain-mvprov2-web-qd-git-a47bf4-quantpaychains-projects.vercel.app,https://quantpaychain-mvprov2-web-qdtm-ho15ttema.vercel.app
      
      - key: WORKERS
        value: 2
      
      - key: LOG_LEVEL
        value: INFO
      
      - key: ENABLE_EARNINGS_SYSTEM
        value: true
      
      - key: ENABLE_AI_ADVISOR
        value: true
